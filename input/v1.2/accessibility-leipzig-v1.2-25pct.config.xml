<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE config SYSTEM "http://www.matsim.org/files/dtd/config_v2.dtd">
<config>
    <module name="TimeAllocationMutator">
        <param name="mutationRange" value="7200.0"/>
    </module>

    <module name="controler">
        <param name="lastIteration" value="0"/>
        <param name="overwriteFiles" value="failIfDirectoryExists"/>
        <param name="runId" value="leipzig-25pct"/>
        <param name="outputDirectory" value="./output/output-leipzig-25pct"/>
        <param name="writeEventsInterval" value="100"/>
        <param name="writePlansInterval" value="100"/>
        <param name="enableLinkToLinkRouting" value="false" />
        <param name="routingAlgorithmType" value="SpeedyALT"/>
    </module>

    <module name="global">
        <param name="coordinateSystem" value="EPSG:25832"/>
        <param name="insistingOnDeprecatedConfigVersion" value="false"/>
        <param name="numberOfThreads" value="14"/>
    </module>

    <module name="network">
        <param name="inputNetworkFile" value="https://svn.vsp.tu-berlin.de/repos/public-svn/matsim/scenarios/countries/de/leipzig/leipzig-v1.2/input/leipzig-v1.2-network-with-pt.xml.gz"/>
        <param name="laneDefinitionsFile" value="null" />
    </module>

    <module name="plans">
        <param name="inputPlansFile"
               value="leipzig-1pct.output_plans.xml.gz"/>
        <param name="removingUnnecessaryPlanAttributes" value="true"/>
    </module>

    <module name="vehicles">
        <param name="vehiclesFile" value="https://svn.vsp.tu-berlin.de/repos/public-svn/matsim/scenarios/countries/de/leipzig/leipzig-v1.2/input/leipzig-v1.2-vehicle-types.xml"/>
    </module>

    <module name="transit">
        <param name="transitScheduleFile"
               value="https://svn.vsp.tu-berlin.de/repos/public-svn/matsim/scenarios/countries/de/leipzig/leipzig-v1.2/input/leipzig-v1.2-transitSchedule.xml.gz"/>
        <param name="vehiclesFile"
               value="https://svn.vsp.tu-berlin.de/repos/public-svn/matsim/scenarios/countries/de/leipzig/leipzig-v1.2/input/leipzig-v1.2-transitVehicles.xml.gz"/>
        <param name="useTransit" value="true"/>
    </module>

    <module name="counts">
        <param name="inputCountsFile" value="./leipzig-v1.2-counts-car-bast.xml.gz"/>
    </module>

    <module name="planscalcroute">
        <!-- Some typical teleportation routing params are set by default, such as for walk and bike.  Setting this switch to "true" will clear them.  Note that this will also clear settings for helper modes such as for non_network_walk -->
        <param name="clearDefaultTeleportedModeParams" value="true" />
        <param name="networkModes" value="car,ride,bike,freight"/>
        <parameterset type="teleportedModeParameters">
            <param name="beelineDistanceFactor" value="1.3"/>
            <param name="mode" value="walk"/>
            <param name="teleportedModeSpeed" value="1.0555556"/>
        </parameterset>
    </module>

    <module name="qsim">
        <param name="startTime" value="00:00:00"/>
        <param name="endTime" value="36:00:00"/>
        <param name="flowCapacityFactor" value="0.25"/>
        <param name="mainMode" value="car,freight"/>
        <param name="numberOfThreads" value="8"/>
        <param name="storageCapacityFactor" value="0.25"/>
        <param name="stuckTime" value="30.0"/>
        <param name="trafficDynamics" value="kinematicWaves"/>
        <param name="useLanes" value="false" />

        <param name="vehiclesSource" value="modeVehicleTypesFromVehiclesData"/>
        <param name="insertingWaitingVehiclesBeforeDrivingVehicles" value="true"/>

        <param name="simEndtimeInterpretation" value="onlyUseEndtime" />
        <param name="simStarttimeInterpretation" value="onlyUseStarttime" />
    </module>

    <module name="ReplanningAnnealer" >
        <param name="activateAnnealingModule" value="true" />
        <parameterset type="AnnealingVariable" >
            <param name="annealParameter" value="globalInnovationRate" />
            <param name="annealType" value="sigmoid" />
            <param name="defaultSubpopulation" value="person" />
            <!-- this parameter enters the exponential and sigmoid formulas. May be an iteration or a share, i.e. 0.5 for halfLife at 50% of iterations. Exponential: startValue / exp(it/halfLife) -->
            <param name="halfLife" value="0.5" />
            <!-- sigmoid: 1/(1+e^(shapeFactor*(it - halfLife))); geometric: startValue * shapeFactor^it; msa: startValue / it^shapeFactor -->
            <param name="shapeFactor" value="0.01" />
            <param name="startValue" value="0.45" />
            <param name="endValue" value="0.01" />
        </parameterset>
    </module>
    <module name="strategy">
        <param name="fractionOfIterationsToDisableInnovation" value="0.9"/>
        <parameterset type="strategysettings">
            <param name="strategyName" value="ChangeExpBeta"/>
            <param name="subpopulation" value="person"/>
            <param name="weight" value="0.85"/>
        </parameterset>
        <parameterset type="strategysettings">
            <param name="strategyName" value="ReRoute"/>
            <param name="subpopulation" value="person"/>
            <param name="weight" value="0.10"/>
        </parameterset>
        <parameterset type="strategysettings">
            <param name="strategyName" value="SubtourModeChoice"/>
            <param name="subpopulation" value="person"/>
            <param name="weight" value="0.10"/>
        </parameterset>
        <parameterset type="strategysettings">
            <param name="strategyName" value="TimeAllocationMutator"/>
            <param name="subpopulation" value="person"/>
            <param name="weight" value="0.10"/>
        </parameterset>
        <!-- Strategies for other subpopulations are added in code -->
    </module>

    <module name="subtourModeChoice">
        <param name="chainBasedModes" value="car,bike"/>
        <param name="modes" value="car,ride,pt,bike,walk"/>
        <param name="considerCarAvailability" value="true"/>
        <param name="behavior" value="betweenAllAndFewerConstraints"/>
        <param name="probaForRandomSingleTripMode" value="0.5" />
        <param name="coordDistance" value="100"/>
    </module>

    <module name="transitRouter">
        <param name="extensionRadius" value="500.0"/>
    </module>

    <module name="travelTimeCalculator">
        <param name="analyzedModes" value="car,freight"/>

        <param name="separateModes" value="true"/>

        <!-- Needed for lane specific routing times -->
        <param name="calculateLinkToLinkTravelTimes" value="false" />
        <param name="calculateLinkTravelTimes" value="true" />
    </module>

    <module name="vspExperimental">
        <param name="vspDefaultsCheckingLevel" value="abort"/>
    </module>

    <module name="planCalcScore">
        <param name="fractionOfIterationsToStartScoreMSA" value="0.9"/>
        <param name="writeExperiencedPlans" value="true"/>

        <parameterset type="scoringParameters">
            <!-- Inflation adjusted  -->
            <param name="performing" value="6.67"/>

            <parameterset type="modeParams">
				<param name="constant" value="0.17892195519778148" />
				<param name="dailyMonetaryConstant" value="-13.22"/>
				<param name="marginalUtilityOfTraveling_util_hr" value="-2.0" />
				<param name="monetaryDistanceRate" value="-0.00025"/>
				<param name="mode" value="car"/>
			</parameterset>
            <parameterset type="modeParams">
				<param name="constant" value="-1.3580961257844513" />
				<param name="dailyMonetaryConstant" value="0.0" />
				<param name="dailyUtilityConstant" value="0.0" />
				<param name="marginalUtilityOfDistance_util_m" value="0.0" />
				<param name="marginalUtilityOfTraveling_util_hr" value="-12.0" />
				<param name="mode" value="ride"/>
			</parameterset>
            <parameterset type="modeParams">
				<param name="constant" value="-0.3523362177545714" />
				<param name="dailyMonetaryConstant" value="0.0" />
				<param name="dailyUtilityConstant" value="0.0" />
				<param name="marginalUtilityOfDistance_util_m" value="0.0" />
				<param name="marginalUtilityOfTraveling_util_hr" value="-7.0" />
                <param name="mode" value="pt"/>
            </parameterset>
            <parameterset type="modeParams">
				<param name="constant" value="0.1179921354777448" />
				<param name="dailyMonetaryConstant" value="0.0" />
				<param name="dailyUtilityConstant" value="0.0" />
				<param name="marginalUtilityOfDistance_util_m" value="0.0" />
				<param name="marginalUtilityOfTraveling_util_hr" value="-10.0" />
                <param name="mode" value="bike"/>
            </parameterset>
            <parameterset type="modeParams">
				<param name="constant" value="0.0" />
				<param name="dailyMonetaryConstant" value="0.0" />
				<param name="dailyUtilityConstant" value="0.0" />
				<param name="marginalUtilityOfDistance_util_m" value="0.0" />
				<param name="marginalUtilityOfTraveling_util_hr" value="-1.5" />
                <param name="mode" value="walk"/>
            </parameterset>

            <parameterset type="modeParams" >
                <param name="marginalUtilityOfTraveling_util_hr" value="-10.0" />
                <param name="monetaryDistanceRate" value="-0.002" />
				<param name="mode" value="freight" />
			</parameterset>

        </parameterset>
    </module>

    <module name="transitRouter">
        <!-- Factor with which direct walk generalized cost is multiplied before it is compared to the pt generalized cost.  Set to a very high value to reduce direct walk results. -->
        <param name="directWalkFactor" value="1.0"/>
        <!-- maximum beeline distance between stops that agents could transfer to by walking -->
        <param name="maxBeelineWalkConnectionDistance" value="300.0"/>
    </module>

	<module name="accessibility" >
		<!-- defines type of measure for accessibility computation. -->
		<param name="accessibilityMeasureType" value="logSum" />
		<!-- method to determine the area for which the accessibility will be computed; possible values: fromNetwork fromBoundingBox fromBoundingBoxHexagons fromShapeFile fromFacilitiesFile fromFacilitiesObject  -->
		<param name="areaOfAccessibilityComputation" value="fromBoundingBox" />
		<!-- custom bounding box parameters for accessibility computation (if enabled) -->
		<param name="boundingBoxBottom" value="5251230.0" />
		<param name="boundingBoxLeft" value="285189.0" />
		<param name="boundingBoxRight" value="918583.0" />
		<param name="boundingBoxTop" value="6086370.0" />
		<param name="extentOfAccessibilityComputationShapeFile" value="null" />
		<param name="measurePointGeometryProvision" value="autoCreate" />
		<!-- if the accibility is computed using the `fromFile` option, the this must be the file containing the measuring points' coordinates.  -->
		<param name="measuringPointsFile" value="null" />
		<param name="outputCRS" value="null" />
		<param name="tileSize_m" value="20000" />
		<!-- time of day at which trips for accessibility computations are assumed to start -->
		<param name="timeOfDay" value="28800.0" />
		<param name="useOpportunityWeights" value="false" />
		<param name="useParallelization" value="true" />
		<param name="weightExponent" value="1.0" />
	</module>

	<module name="facilities" >
		<param name="inputFacilitiesFile" value="facilities.xml" />
	</module>

</config>
